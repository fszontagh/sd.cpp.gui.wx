#ifndef __MainWindowCivitAiWindow__
#define __MainWindowCivitAiWindow__

/**
@file
Subclass of CivitAiWindow, which is generated by wxFormBuilder.
*/

#include "MainWindow.h"

//// end generated include
#include "ver.hpp"

#include <wx/msgdlg.h>

#include <sstream>
#include <thread>
#include <vector>

#include <curlpp/cURLpp.hpp>
#include <curlpp/Easy.hpp>
#include <curlpp/Options.hpp>
#include "../libs/json.hpp"
#include "../helpers/civitaiHttp.hpp"

/** Implementing CivitAiWindow */
class MainWindowCivitAiWindow : public CivitAiWindow
{
protected:
	// Handlers for CivitAiWindow events.
	void m_civitai_searchOnTextEnter(wxCommandEvent &event);
	void m_searchOnButtonClick(wxCommandEvent &event);
	void m_dataViewListCtrl5OnDataViewListCtrlSelectionChanged(wxDataViewEvent &event);
	void m_model_detailsOnDataViewListCtrlSelectionChanged(wxDataViewEvent &event);
	void m_model_filelistOnDataViewListCtrlSelectionChanged(wxDataViewEvent &event);

public:
	/** Constructor */
	MainWindowCivitAiWindow(wxWindow *parent);
	//// end generated class members

	~MainWindowCivitAiWindow();

private:
	std::vector<std::thread *> modelDownloadThread;
	std::vector<std::thread *> infoDownloadThread;
	std::vector<nlohmann::json *> loadedJsonDatas;
	nlohmann::json selectedModelVersion;

	void civitSearchThread(std::string query);
	void OnSearch(std::string query);
	void OnThreadMessage(wxThreadEvent &e);
	void JsonToTable(std::string json_str);
};

#endif // __MainWindowCivitAiWindow__
